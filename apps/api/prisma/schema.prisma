generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String           @id @default(cuid()) @db.Uuid
  email       String           @unique
  phone       String?
  avatar      String?
  createdAt   DateTime         @default(now())
  firstName   String
  lastName    String
  updatedAt   DateTime         @updatedAt
  reviews     Review[]
  preferences UserPreferences?

  @@map("users")
}

model UserPreferences {
  id                          String    @id @default(cuid())
  userId                      String    @unique @db.Uuid
  destinationCity             String
  destinationCountry          String
  budgetAccommodationMin      Int?
  budgetAccommodationMax      Int?
  budgetCourseMin             Int?
  budgetCourseMax             Int?
  purpose                     String
  englishLevel                String?
  arrivalDate                 DateTime?
  preferredAccommodationTypes String[]  @default([])
  maxDistanceToSchool         Int?
  hasUnreadNotifications      Boolean   @default(false)
  notificationCount           Int       @default(0)
  createdAt                   DateTime  @default(now())
  updatedAt                   DateTime  @updatedAt
  user                        User      @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "user_preferences_users_fk")

  @@index([destinationCity])
  @@index([destinationCountry])
  @@index([budgetAccommodationMax])
  @@index([englishLevel])
  @@map("user_preferences")
}

model Course {
  id             String   @id(map: "Course_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schoolId       String   @db.Uuid
  programName    String   @db.VarChar(255)
  weeklyHours    Int
  priceInCents   Int?
  description    String
  duration       String   @db.VarChar(100)
  visaType       String   @db.VarChar(100)
  targetAudience String
  image          String   @db.VarChar(500)
  images         String[] @default([])
  badge          String?  @db.VarChar(100)
  rating         Decimal? @default(0.00) @db.Decimal(3, 2)
  ratingCount    Int?     @default(0)
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())
  school         School   @relation(fields: [schoolId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "course_school_fk")

  @@map("course")
}

model Review {
  id             String   @id(map: "Review_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId         String   @db.Uuid
  reviewableType String
  reviewableId   String   @db.Uuid
  rating         Int
  comment        String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())
  user           User     @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_users_fk")

  @@map("review")
}

model School {
  id          String   @id(map: "School_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String   @db.VarChar(255)
  location    String   @db.VarChar(255)
  description String?
  website     String?  @db.VarChar(500)
  phone       String?  @db.VarChar(50)
  email       String?  @db.VarChar(255)
  logo        String?  @db.VarChar(500)
  isPartner   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())
  courses     Course[]

  @@map("school")
}

model Accommodation {
  id                  String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title               String    @db.VarChar(255)
  accommodationType   String    @map("accommodation_type") @db.VarChar(50)
  priceInCents        Int       @map("price_in_cents")
  priceUnit           String    @default("month") @map("price_unit") @db.VarChar(20)
  location            String    @db.VarChar(255)
  areaHint            String?   @map("area_hint") @db.VarChar(255)
  latitude            Decimal?  @db.Decimal(10, 8)
  longitude           Decimal?  @db.Decimal(11, 8)
  description         String
  rules               String[]  @default([])
  amenities           String[]  @default([])
  image               String    @db.VarChar(500)
  images              String[]  @default([])
  rating              Decimal?  @default(0.00) @db.Decimal(3, 2)
  ratingCount         Int?      @default(0) @map("rating_count")
  ratingCleanliness   Decimal?  @default(0.00) @map("rating_cleanliness") @db.Decimal(3, 2)
  ratingLocation      Decimal?  @default(0.00) @map("rating_location") @db.Decimal(3, 2)
  ratingCommunication Decimal?  @default(0.00) @map("rating_communication") @db.Decimal(3, 2)
  ratingValue         Decimal?  @default(0.00) @map("rating_value") @db.Decimal(3, 2)
  goodFor             String?   @map("good_for")
  isPartner           Boolean?  @default(false) @map("is_partner")
  isTopTrip           Boolean?  @default(false) @map("is_top_trip")
  hostName            String?   @map("host_name") @db.VarChar(255)
  hostAvatar          String?   @map("host_avatar") @db.VarChar(500)
  isActive            Boolean?  @default(true) @map("is_active")
  createdAt           DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt           DateTime? @default(now()) @map("updated_at") @db.Timestamp(6)

  @@map("accommodation")
}

model Place {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name              String    @db.VarChar(255)
  category          String    @db.VarChar(50)
  image             String
  images            String[]  @default([])
  rating            Decimal?  @default(0) @db.Decimal(2, 1)
  ratingCount       Int?      @default(0) @map("rating_count")
  address           String
  neighborhood      String?   @db.VarChar(100)
  latitude          Decimal?  @db.Decimal(10, 8)
  longitude         Decimal?  @db.Decimal(11, 8)
  isStudentFavorite Boolean?  @default(false) @map("is_student_favorite")
  hasDeal           Boolean?  @default(false) @map("has_deal")
  dealDescription   String?   @map("deal_description")
  priceRange        String?   @map("price_range") @db.VarChar(10)
  description       String?
  hours             Json?
  phone             String?   @db.VarChar(50)
  website           String?
  amenities         String[]  @default([])
  isActive          Boolean?  @default(true) @map("is_active")
  createdAt         DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt         DateTime? @default(now()) @map("updated_at") @db.Timestamp(6)

  @@map("place")
}
