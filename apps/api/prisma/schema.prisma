generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String           @id @default(cuid()) @db.Uuid
  email       String           @unique
  phone       String?
  avatar      String?
  createdAt   DateTime         @default(now())
  firstName   String
  lastName    String
  updatedAt   DateTime         @updatedAt
  review      review[]
  preferences UserPreferences?

  @@map("users")
}

model UserPreferences {
  id                          String    @id @default(cuid())
  userId                      String    @unique @db.Uuid
  destinationCity             String
  destinationCountry          String
  budgetAccommodationMin      Int?
  budgetAccommodationMax      Int?
  budgetCourseMin             Int?
  budgetCourseMax             Int?
  purpose                     String
  englishLevel                String?
  arrivalDate                 DateTime?
  preferredAccommodationTypes String[]  @default([])
  maxDistanceToSchool         Int?
  hasUnreadNotifications      Boolean   @default(false)
  notificationCount           Int       @default(0)
  createdAt                   DateTime  @default(now())
  updatedAt                   DateTime  @updatedAt
  user                        User      @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "user_preferences_users_fk")

  @@index([destinationCity])
  @@index([destinationCountry])
  @@index([budgetAccommodationMax])
  @@index([englishLevel])
  @@map("user_preferences")
}

model course {
  id             String   @id(map: "Course_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  schoolId       String   @db.Uuid
  programName    String   @db.VarChar(255)
  weeklyHours    Int
  priceInCents   Int?
  description    String
  duration       String   @db.VarChar(100)
  visaType       String   @db.VarChar(100)
  targetAudience String
  image          String   @db.VarChar(500)
  images         String[] @default([])
  badge          String?  @db.VarChar(100)
  rating         Decimal? @default(0.00) @db.Decimal(3, 2)
  ratingCount    Int?     @default(0)
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())
  school         school   @relation(fields: [schoolId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "course_school_fk")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model review {
  id             String   @id(map: "Review_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId         String   @db.Uuid
  reviewableType String
  reviewableId   String   @db.Uuid
  rating         Int
  comment        String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())
  users          User     @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_users_fk")
}

model school {
  id          String   @id(map: "School_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String   @db.VarChar(255)
  location    String   @db.VarChar(255)
  description String?
  website     String?  @db.VarChar(500)
  phone       String?  @db.VarChar(50)
  email       String?  @db.VarChar(255)
  logo        String?  @db.VarChar(500)
  isPartner   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())
  course      course[]
}
